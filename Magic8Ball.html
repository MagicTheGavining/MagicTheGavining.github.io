<!DOCTYPE html>
<!-- This is based on DillingerLee's great template here:
https://github.com/Team-Code/KA_Offline -->
<html> 
 <head>
 	<meta charset="utf-8">
    <title>Magic 8 Ball</title> 
</head>
 <body>
    <p align="center"> 
	<!--This draws the Canvas on the webpage -->
      <canvas id="mycanvas"></canvas> 
    </p>
 </body>
 
 <!-- Run all the JavaScript stuff -->
 <!-- Include the processing.js library -->
 <!-- See https://khanacademy.zendesk.com/hc/en-us/articles/202260404-What-parts-of-ProcessingJS-does-Khan-Academy-support- for differences -->
 <script src="https://cdn.jsdelivr.net/processing.js/1.4.8/processing.min.js"></script> 
 
 <script>
 	var smallestDim = 100; //Smallest dimension I am allowing.
 	if( (window.innerWidth <= window.innerHeight) && (window.innerWidth > 99)){
 		smallestDim = window.innerWidth;
 	} else if( (window.innerWidth > window.innerHeight) && (window.innerHeight > 99)){
 		smallestDim = window.innerHeight;
 	}
    var sketchProc = function(processingInstance) {
     with (processingInstance) {
        size(smallestDim, smallestDim); 
        frameRate(30);
        
        // ProgramCodeGoesHere
/*****************
* Modified by MagicTheGavining
* Oct. 25 & 31, 2019
* Nov. 2, 2019
* Feb. 26 - 29, 2020
* +Font scaling function that
*  mostly works!!!
* +Scaling of all image parts to
*  different canvas sizes!  Ach! 
*  the crazy amount of global vars!!!
* +Reveal number of possible
*  answers when lower left is clicked
* +Infused with purple spirit power!
* +Switch Statement to replace if/else
* +Different Colored triangles
* +Function to draw triangle
* +8 Ball's Number
* +Purple liquid behind triangle
* +Ask button and instructions
* +Color changing button
* +Sparks on new answer
*****************/

//Obtain dimensions from canvas size, so it can adjust to screen/browser on startup
var canvasCenter = width/2;
var mainBallSize = (width * 0.7625);
var purpleLiquidSize = (width * 0.445);
var mainWhiteCircleY = (height * 0.1875);
var mainWhiteCircleWidth = (width * 0.245);
var mainWhiteCircleHeight = (height * 0.1175);
var main8X = (width * 0.465);
var main8Y = (height * 0.2175);

var miniBallCenterX = (width * 0.93);
var miniBallCenterY = (height * 0.863);
var miniBallSize = (width * 0.045);
var miniWhiteCircleSize = (width * 0.03);
var mini8X = (width * 0.925);
var mini8Y = (height * 0.871);

var triangleTopPeakY = (height * 0.3075);
var triangleBottomRightCornerX = (width * 0.6775);
var triangleBottomCornersY = (height * 0.62);
var triangleBottomLeftCornerX = (width * 0.3225);

var askButtonX = (width * 0.75);
var askButtonY = (height * 0.793);
var askButtonWidth = (width * 0.2175);
var askButtonHeight = (height * 0.125);
var askTextX = (width * 0.7825);
var askTextY = (height * 0.88);
var askRightEdge = (askButtonX + askButtonWidth);
var askBottomEdge = (askButtonY + askButtonHeight);

var textAX = (width * 0.46);
var textAY = (height * 0.4625);
var textBX = (width * 0.4075);
var textBY = (height * 0.505);
var textCX = (width * 0.385);
var textCY = (height * 0.5475);
var textDX = (width * 0.36);
var textDY = (height * 0.59);

var numX = (width * 0.02);
var numY = (height  * 0.822);
var numWidth = (width * 0.475);
var numHeight = (height * 0.1);
var numRightEdge = (numX + numWidth);
//var numBottomEdge = (numY + numHeight); same as "height"

var strokeWeight12 = round(width * 0.03);
var strokeWeight10 = round(width * 0.025);
var strokeWeight8 = round(width * 0.02);
var strokeWeight5 = round(width * 0.0125);
var strokeWeight4 = round(width * 0.01);
var strokeWeight2 = round(width * 0.005);

//Global variables used in animations
var colorShift = 0;
var increaseColor = true;
var magicSparks = false;
var fadeInAnswer = false;
var alphaAnswer = 0;
var sparkDistance = 0;
var sparkSizeA = 3;
var sparkSizeB = 3;
var sparkSizeC = 3;
var sparkSizeD = 3;
var sparkDistanceModifier = round(width * 0.0025);
var glowing8X = (width * 0.4625);
var glowing8Y = (height * 0.22);
var coverOpacity = 255;

//Background
var START_BG_RED = 197;
var START_BG_GREEN = 120;
var START_BG_BLUE = 20;
var bgRed = START_BG_RED;
var bgGreen = START_BG_GREEN;
var bgBlue = START_BG_BLUE;

//Defining an upper limit on # of answers
var UPPER_LIMIT = 41;
var answer = UPPER_LIMIT;

//Making sure the text answers have a standard size
//and appearance with a monospace font
var fontMono = createFont("monospace");


//Generate a random number out of 5 possibilities
//THIS is the entire logic of picking what answer
//the 8 Ball gives you.
var ask8Ball = function(){
    answer = floor(random(0, UPPER_LIMIT));
};

var scaleTextSize = function (originalSize){
    var newTextSize = (originalSize * (6/13)) / 400;
    newTextSize = ((newTextSize * width) * (13/6));
    return newTextSize;
};
var askTextSize = scaleTextSize(25);
var big8TextSize = scaleTextSize(39);
var mini8TextSize = scaleTextSize(7);

//Draw the triangle inside the 8-Ball using this function
var drawTriangle = function(triangleColor, textColor, sizeForText, messageLineA, messageLineB, messageLineC, messageLineD){
    fill(triangleColor);
    triangle(canvasCenter, triangleTopPeakY, triangleBottomRightCornerX, triangleBottomCornersY, triangleBottomLeftCornerX, triangleBottomCornersY);
    fill(textColor);
    textSize(sizeForText);
    text(messageLineA, textAX, textAY);
    text(messageLineB, textBX, textBY);
    text(messageLineC, textCX, textCY);
    text(messageLineD, textDX, textDY);
};



draw = function() {
    
    
    //Background fading out
    if (magicSparks && bgRed > 0){
        bgRed -= 3;
    }
    if (magicSparks && bgGreen > 0){
        bgGreen -= 3;
    }
    if (magicSparks && bgBlue > 0){
        bgBlue -= 3;
    }
    
    //Background fading in
    if (!magicSparks && bgRed < START_BG_RED) {
        bgRed++;
    }
    if (!magicSparks && bgGreen < START_BG_GREEN) {
        bgGreen++;
    }
    if (!magicSparks && bgBlue < START_BG_BLUE) {
        bgBlue++;
    }
    
    background(bgRed, bgGreen, bgBlue);
    
    
    textFont(fontMono, 20); //Make a default text
    
    //Draw the 8-Ball
    fill(0);
    ellipse(canvasCenter, canvasCenter, mainBallSize, mainBallSize);
    
    //Purple liquid
    fill(45, 0, 82);
    ellipse(canvasCenter, canvasCenter, purpleLiquidSize, purpleLiquidSize);
    
    //8 Ball label
    fill("white");
    ellipse(canvasCenter, mainWhiteCircleY, mainWhiteCircleWidth, mainWhiteCircleHeight);
    fill(0);
    textSize(big8TextSize);
    text("8", main8X, main8Y);
    
    //Asking Button
    strokeWeight(strokeWeight4);
    stroke(0);
    
    //Cycle Ask button between dark and light blue
    if( colorShift >= 80 && increaseColor){
        increaseColor = false;
    } else if(increaseColor && colorShift <=80){
        colorShift = colorShift + 1;
    } else if (colorShift >= 0 && !increaseColor){
        colorShift--;
    } else { //colorShift has dropped below 0
        increaseColor = true;
    }
    fill((0 + colorShift), (0 + colorShift), (70 + colorShift));
        rect(askButtonX, askButtonY, askButtonWidth, askButtonHeight, strokeWeight4);
    fill(255, 255, 255);
    textSize(askTextSize);
    text("Ask", askTextX, askTextY);
    
    //Draw mini 8 Ball
    strokeWeight(0);
    fill(0);
    ellipse(miniBallCenterX, miniBallCenterY, miniBallSize, miniBallSize);
    fill(255);
    ellipse(miniBallCenterX, miniBallCenterY, miniWhiteCircleSize, miniWhiteCircleSize);
    fill(0);
    textSize(mini8TextSize);
    text("8", mini8X, mini8Y);
    strokeWeight(strokeWeight2);
    
    //Reveal amount of possible answers
    textSize(16);
    if(fadeInAnswer) {
        alphaAnswer += 2;
    } else {
        alphaAnswer = 0;
    }
    fill(242, 255, 0, alphaAnswer);
    text("The 8 Ball has: " + UPPER_LIMIT + " possible answers", numX, numY, numWidth, numHeight);
    
    //Output different answers depending on what random number
    //was assigned to the "answer" variable
    //Using switch instead of if/else - more concise.
    //answer = 13;
    switch(answer){
         case 0:
            drawTriangle(color(255, 247, 0), color(0), scaleTextSize(13), "THE", "BUZZING", "BEEHIVE HAS", "  TOLD ME YES!");
        break;
        case 1:
            drawTriangle(color(0, 189, 13), color(255, 255, 255), scaleTextSize(14), "YES!", "CERTAINLY");
        break;
        case 2:
            drawTriangle(color(161, 0, 0), color(255, 247, 0), scaleTextSize(14), "NO,", " IT WILL", "NOT HAPPEN!");
        break;
        case 3:
            drawTriangle(color(87, 86, 83), color(255), scaleTextSize(16), "", " MAYBE,", "  ANSWER", " IS UNCLEAR");
        break;
        case 4:
            drawTriangle(color(201, 0, 184), color(255), scaleTextSize(11), "YOU", "ARE STRUCK", "BY SOMETHING", "FLUFFY AND SOFT!");
        break;
        case 5:
            drawTriangle(color(252, 185, 41), color(143, 135, 30), scaleTextSize(17), "", "ANSWER", "HAZY: TRY", "AGAIN LATER.");
        break;
        case 6:
            drawTriangle(color(255, 242, 0), color(0), scaleTextSize(14), "YES,", "OF THIS I", "AM CERTAIN!");
        break;
        case 7:
            drawTriangle(color(255, 0, 30), color(255, 236, 94), scaleTextSize(16), "YOU", "ALREADY", " KNOW THE", "   ANSWER...");
        break;
        case 8:
            drawTriangle(color(23, 22, 15), color(222, 33, 206), scaleTextSize(14), "NOT", "  WORTH ", "  YOUR TIME", "  OR EFFORTS!");
        break;
        case 9:
            drawTriangle(color(0, 255, 208), color(0, 8, 94), scaleTextSize(14), " IT", "SOUNDS", "GOOD, BUT", "DOESN'T WORK.");
        break;
        case 10:
            drawTriangle(color(238, 133, 245), color(196, 6, 6), scaleTextSize(14),  "YOU", " REALLY", " WEAR THAT", "OUTFIT WELL!");
        break;
        case 11:
            drawTriangle(color(105, 105, 105), color(10, 8, 8), scaleTextSize(14),  "I", "HATE TO ", "BEAR BAD", "NEWS, BUT.. NO");
        break;
        case 12:
            drawTriangle(color(156, 165, 166), color(138, 255, 198), scaleTextSize(14), "THE", "SPIRIT IS", "WHISPERING", "  \"STAY HOME\"");
        break;
        case 13:
            drawTriangle(color(64, 117, 0), color(17, 61, 15), scaleTextSize(21), "THE", " TEA", " LEAVES", "SAY YES!!");
        break;
        case 14:
            drawTriangle(color(0, 227, 201), color(0, 0, 0), scaleTextSize(21), "ALL", "SIGNS", " POINT", " TO YES.");
        break;
        case 15:
            drawTriangle(color(227, 0, 0), color(0, 0, 0), scaleTextSize(15), "TOO", "  MUCH", "  DEMONIC", "INTERFERENCE");
        break;
        case 16:
            drawTriangle(color(255, 255, 255), color(117, 117, 0), scaleTextSize(15),  "AN", "ANGEL IS", " BLESSING", " YOU, YES!!");
        break;
        case 17:
            drawTriangle(color(0, 0, 0), color(102, 102, 100), scaleTextSize(17),  "", "  AS", "THE CROW", "FLIES, YES!");
        break;
        case 18:
            drawTriangle(color(9, 140, 4), color(126, 255, 122), scaleTextSize(16),  "", " LUCKY", " YOU!!!!", "ABSOLUTELY!");
        break;
        case 19:
            drawTriangle(color(138, 4, 4), color(255), scaleTextSize(20),  "YOU", " SMELL", " GREAT", " TODAY!!");
        break;
        case 20:
            drawTriangle(color(71, 43, 0), color(194, 154, 54), scaleTextSize(18),  "IT'S", "CARVED", " IN THE", " WOOD, YES.");
        break;
        case 21:
            drawTriangle(color(92, 0, 0), color(255, 174, 0),  scaleTextSize(14),  "THE", " FLAME IS", "LIT, BUT IT", " NEEDS FANNING");
        break;
        case 22:
            drawTriangle(color(5, 46, 0), color(207, 206, 203),  scaleTextSize(14),  "IT'S", " NAILS ON", "A CHALKBOARD", "  NO! STOP!!!");
        break;
        case 23:
            drawTriangle(color(0, 148, 113), color(0, 11, 46),  scaleTextSize(14),  "THE", "WEST WIND", " IS HOWLING", "  AGAINST IT!!");
        break;
        case 24:
            drawTriangle(color(43, 36, 3),color(139, 240, 215),  scaleTextSize(13),  "YES,", "BUT ONLY", "AFTER STRONG", " BLACK COFFEE!");
        break;
        case 25:
            drawTriangle(color(189, 169, 79),color(0, 0, 0),  scaleTextSize(12),  "PICK", " A RANDOM", " BIBLE VERSE", " FOR AN ANSWER");
        break;
        case 26:
            drawTriangle(color(199, 0, 10), color(248, 156, 255), scaleTextSize(15),  "THE", "WAY YOUR", "HAIR FALLS", " IS PERFECT!");
        break;
        case 27:
            drawTriangle(color(110, 234, 245), color(8, 43, 0), scaleTextSize(14),  "ON", " A SCALE", " FROM 1 TO", "10, YOU'RE 11!");
        break;
        case 28:
            drawTriangle(color(219, 168, 0), color(71, 9, 128), scaleTextSize(11),  "YOU", "ARE REALLY", " RIDICULOUSLY", "  GOOD LOOKING!");
        break;
        case 29:
            drawTriangle(color(133, 111, 40), color(0), scaleTextSize(17),  "I", "CAST", "THE RUNES", "AND... NO!");
        break;
        case 30:
            drawTriangle(color(133, 111, 40), color(0), scaleTextSize(17),  "I", "CAST", "THE RUNES", "AND... YES!");
        break;
        case 31:
            drawTriangle(color(112, 29, 29), color(232, 14, 14), scaleTextSize(17),  "THE", "SQUISHY", "ENTRAILS", "TELL ME NO!");
        break;
        case 32:
            drawTriangle(color(112, 29, 29), color(232, 14, 14), scaleTextSize(17),  "THE", "SQUISHY", "ENTRAILS", "  SAY YES!");
        break;
        case 33:
            drawTriangle(color(7, 28, 11), color(130, 130, 130), scaleTextSize(17),  "DO", "NOT TOY", "WITH THAT", "IDEA, EVER.");
        break;
        case 34:
            drawTriangle(color(207, 185, 131), color(156, 22, 22), scaleTextSize(15),  "THE", "HEADLESS", "  CHICKEN", "FELL ON \"NO\"");
        break;
        case 35:
            drawTriangle(color(207, 185, 131), color(156, 22, 22), scaleTextSize(14),  "THE", "HEADLESS", "  CHICKEN", "FELL ON \"YES\"");
        break;
        case 36:
            drawTriangle(color(132, 188, 207), color(0, 12, 102), scaleTextSize(14),  "THE", "CRYSTAL", "BALL FORE-", "SEES HAPPINESS.");
        break;
        case 37:
            drawTriangle(color(132, 188, 207), color(0, 12, 102), scaleTextSize(14),  "THE", "CRYSTAL", "BALL FORE-", "SEES SORROW.");
        break;
        case 38:
            drawTriangle(color(189, 145, 0), color(16, 97, 16), scaleTextSize(14),  "THE", "  OOMPA", "LOOMPAS WILL", "   JUICE YOU.");
        break;
        case 39:
            drawTriangle(color(230, 194, 74), color(64, 33, 0), scaleTextSize(14),  "SAYTH", " FLYING", " SPAGHETTI", "MONSTER: \"YEA\"");
        break;
        case 40:
            drawTriangle(color(112, 76, 255), color(2, 56, 0), scaleTextSize(18),  "A", "CHANGE", "OCCURRED", "FOR GOOD!!");
        break;
        /***** TEMPLATE, KEEP AT END TO ADD MORE ANSWERS EASILY *****
        case 40:
            drawTriangle(color(112, 76, 255), color(2, 56, 0), 13,  "", "", "", "");
        break;
        */
        default: //Impossible answer to start
            drawTriangle(color(5, 50, 250), color(255), scaleTextSize(11), "THINK", "OF A YES OR", " NO QUESTION,", "  THEN ASK ME!!");
        
    }
    
    if(magicSparks && sparkDistance < 85){
        strokeWeight(random(strokeWeight4, strokeWeight12));
        stroke(color(45, 0, 82, 220));
        drawTriangle(color(45, 0, 82, coverOpacity));
        fill(255, 0, 242);
        ellipse(canvasCenter, canvasCenter + sparkDistance, sparkSizeA, sparkSizeA);
        ellipse(canvasCenter + sparkDistance, canvasCenter, sparkSizeC, sparkSizeC);
        ellipse(canvasCenter + (sparkDistance/1.7), canvasCenter + (sparkDistance/1.7), sparkSizeB, sparkSizeB);
        ellipse(canvasCenter + (sparkDistance/1.7), canvasCenter - (sparkDistance/1.7), sparkSizeD, sparkSizeD);
        ellipse(canvasCenter - (sparkDistance/1.7), canvasCenter + (sparkDistance/1.7), sparkSizeD, sparkSizeD);
        ellipse(canvasCenter - (sparkDistance/1.7), canvasCenter - (sparkDistance/1.7), sparkSizeB, sparkSizeB);
        ellipse(canvasCenter - sparkDistance, canvasCenter, sparkSizeC, sparkSizeC);
        ellipse(canvasCenter, canvasCenter - sparkDistance, sparkSizeA, sparkSizeA);
        sparkSizeA = floor(random(1, strokeWeight8));
        sparkSizeB = floor(random(1, strokeWeight12));
        sparkSizeC = floor(random(1, strokeWeight10));
        sparkSizeD = floor(random(1, strokeWeight5));
        sparkDistance += sparkDistanceModifier;
        coverOpacity -= 1;
        textSize(big8TextSize + sparkSizeD);
        fill(150, 0, 230);
        text("8", glowing8X, glowing8Y);
    } else {
        sparkDistance =0;
        coverOpacity = 255;
        magicSparks = false;
        stroke(0);
    }

};

mouseClicked = function(){
    //Check for Clicking of Ask Button
    if ((mouseX >= askButtonX && mouseX <askRightEdge) && (mouseY >= askButtonY && mouseY <= askBottomEdge)){
        ask8Ball();
        magicSparks = true;
    }
    
    //Check for revealing amount of answers
    if ((mouseX >= numX && mouseX <numRightEdge) && (mouseY >= numY && mouseY <= height)){
        fadeInAnswer  = true;
    } else {
        fadeInAnswer = false;
    }
};


    }};

    // Get the canvas that Processing-js will use
    var canvas = document.getElementById("mycanvas"); 
    // Pass the function sketchProc (defined in myCode.js) to Processing's constructor.
    var processingInstance = new Processing(canvas, sketchProc); 
 </script>

</html>
